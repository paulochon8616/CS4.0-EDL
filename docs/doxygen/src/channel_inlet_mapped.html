<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Infinite channel inlet</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">programmer&#39;s documentation</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="cs_user_examples.html"><span>User&#160;examples</span></a></li>
      <li><a href="cs_var_dico.html"><span>Fortran-C&#160;naming&#160;reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="cs_user_examples.html">User examples</a></li><li class="navelem"><a class="el" href="cs_user_boundary_conditions_examples.html">cs_user_boundary_conditions.f90</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Infinite channel inlet </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A method of defining an inlet condition which converges towards an infinite channel profile is based simply on feedback from values computed downstream from the inlet.</p>
<p>Here, we define an inlet boundary condition for a very long channel or duct with a section matching the boundary faces of group 'INLET'.</p>
<h1><a class="anchor" id="channel_inlet_mapped_loc_var_bc"></a>
Local variables to be added</h1>
<p>The following local variables need to be defined for the examples in this section:</p>
<div class="fragment"><div class="line"><span class="keywordtype">integer</span>          ifac, iel, ii, ivar, iscal, ilelt, nlfac</div>
<div class="line"><span class="keywordtype">double precision</span> xkent, xeent</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">integer</span>          keyvar, keysca</div>
<div class="line"><span class="keywordtype">integer</span>          n_fields, f_id, normalize, interpolate</div>
<div class="line"><span class="keywordtype">double precision</span> xustar2, xdh, d2s3, rhomoy</div>
<div class="line"><span class="keywordtype">double precision</span> fmprsc, uref2</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: lstfac, lstcel</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: brom</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">pointer</span> :: vel</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(3,1)</span> :: coord_shift</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(1)</span> :: rvoid</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">type(</span>c_ptr<span class="keywordtype">)</span>, <span class="keywordtype">save</span> :: inlet_l = c_null_ptr</div>
</div><!-- fragment --><p> Note that the <code>inlet_l</code> pointer has the <code>save</code> attribute, as the matching structure usually needs to be built only once, then reused at each time step.</p>
<h1><a class="anchor" id="channel_inlet_mapped_init_bc"></a>
Initialization and finalization</h1>
<p>Initialization and finalization is similar to that of the base examples, with the addition of the mapping object, described in a specific section hereafter</p>
<h1><a class="anchor" id="channel_inlet_mapped_example_1_base"></a>
Base definition</h1>
<dl class="section warning"><dt>Warning</dt><dd>We assume other boundary conditions are defined before this one (ideally, using the GUI).</dd></dl>
<p>The base definition given here ensures initialization of a (flat) inlet profile with the required mean velocity.</p>
<dl class="section note"><dt>Note</dt><dd>We may skip the addition of the following block in the user subroutine if we define an equivalent inlet condition using the GUI, which will ensure the appropriate initialization before entering the user subroutine.</dd></dl>
<div class="fragment"><div class="line"><span class="comment">call getfbr(&#39;INLET&#39;, nlfac, lstfac)</span></div>
<div class="line"><span class="comment">!==========</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">do</span> ilelt = 1, nlfac</div>
<div class="line"></div>
<div class="line">  ifac = lstfac(ilelt)</div>
<div class="line">  iel = <a class="code" href="group__mesh.html#ga0d1cf9f4d3d0b6219ac4c4bda4797470">ifabor</a>(ifac)</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group__coupled__case.html#ga60f3df1381261b9527adb47ac21aa62d">itypfb</a>(ifac) = <a class="code" href="group__paramx.html#gacd9bb8a485ad1e678b9a9a42ed812d22">ientre</a></div>
<div class="line"></div>
<div class="line">  rcodcl(ifac,<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>,1) = fmprsc</div>
<div class="line">  rcodcl(ifac,<a class="code" href="group__main__variables.html#ga92b62f3d921525535a93525229a106a2">iv</a>,1) = 0.d0</div>
<div class="line">  rcodcl(ifac,<a class="code" href="group__main__variables.html#gafe8e8df233ec94d884116c7d0aa29ef2">iw</a>,1) = 0.d0</div>
<div class="line"></div>
<div class="line">  uref2 =   rcodcl(ifac,<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>,1)**2  &amp;</div>
<div class="line">          + rcodcl(ifac,<a class="code" href="group__main__variables.html#ga92b62f3d921525535a93525229a106a2">iv</a>,1)**2  &amp;</div>
<div class="line">          + rcodcl(ifac,<a class="code" href="group__main__variables.html#gafe8e8df233ec94d884116c7d0aa29ef2">iw</a>,1)**2</div>
<div class="line">  uref2 = max(uref2,1.d-12)</div>
<div class="line"></div>
<div class="line">  <span class="comment">!   Turbulence example computed using equations valid for a pipe.</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">!   We will be careful to specify a hydraulic diameter adapted</span></div>
<div class="line">  <span class="comment">!     to the current inlet.</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">!   We will also be careful if necessary to use a more precise</span></div>
<div class="line">  <span class="comment">!     formula for the dynamic viscosity use in the calculation of</span></div>
<div class="line">  <span class="comment">!     the Reynolds number (especially if it is variable, it may be</span></div>
<div class="line">  <span class="comment">!     useful to take the law from &#39;usphyv&#39;. Here, we use by default</span></div>
<div class="line">  <span class="comment">!     the &#39;viscl0&quot; value.</span></div>
<div class="line">  <span class="comment">!   Regarding the density, we have access to its value at boundary</span></div>
<div class="line">  <span class="comment">!     faces (romb) so this value is the one used here (specifically,</span></div>
<div class="line">  <span class="comment">!     it is consistent with the processing in &#39;usphyv&#39;, in case of</span></div>
<div class="line">  <span class="comment">!     variable density)</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">!     Hydraulic diameter</span></div>
<div class="line">  xdh     = 1.d0</div>
<div class="line"></div>
<div class="line">  <span class="comment">!   Calculation of friction velocity squared (ustar2)</span></div>
<div class="line">  <span class="comment">!     and of k and epsilon at the inlet (xkent and xeent) using</span></div>
<div class="line">  <span class="comment">!     standard laws for a circular pipe</span></div>
<div class="line">  <span class="comment">!     (their initialization is not needed here but is good practice).</span></div>
<div class="line">  rhomoy  = brom(ifac)</div>
<div class="line">  xustar2 = 0.d0</div>
<div class="line">  xkent   = <a class="code" href="group__cstnum.html#ga7ce13e6a1bb416f0bdffcaf431135084">epzero</a></div>
<div class="line">  xeent   = <a class="code" href="group__cstnum.html#ga7ce13e6a1bb416f0bdffcaf431135084">epzero</a></div>
<div class="line"></div>
<div class="line">  call <a class="code" href="turent_8f90.html#a689f0f36b3b4c8f1a62b83b61358c5f7">keendb</a> &amp;</div>
<div class="line">  <span class="comment">!==========</span></div>
<div class="line">  ( uref2, xdh, rhomoy, <a class="code" href="group__cstphy.html#gab7fbc85b2a13abe8a8d6a4df343995b3">viscl0</a>, <a class="code" href="group__csttur.html#ga019fba8a896d405a7cae1c2f960fd521">cmu</a>, <a class="code" href="group__csttur.html#ga0cb384d0acda415e2d329b4d807c584a">xkappa</a>,   &amp;</div>
<div class="line">    xustar2, xkent, xeent )</div>
<div class="line"></div>
<div class="line">  <span class="comment">! itytur is a flag equal to iturb/10</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__turbulence.html#ga65b4137820e92089e0ae2eae651509e4">itytur</a>.eq.2) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga0da9329edbed84e564928b950e9d9570">ik</a>,1)  = xkent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga52f2cbc26bf83508a779335c668f2895">iep</a>,1) = xeent</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">elseif</span> (<a class="code" href="group__turbulence.html#ga65b4137820e92089e0ae2eae651509e4">itytur</a>.eq.3) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga371f21c313d2820f269cc3dca293afe0">ir11</a>,1) = d2s3*xkent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#gad23a1c619be0989736f6a5ad37447790">ir22</a>,1) = d2s3*xkent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#gad511370b805821b77393645adcab562a">ir33</a>,1) = d2s3*xkent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#gafaa05f3eb9f8a6fdbf883159c8c38829">ir12</a>,1) = 0.d0</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga7041cb277fde45af4f797bb0629f045d">ir13</a>,1) = 0.d0</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga02ee51e389e3eb413a72d0ad688ffb39">ir23</a>,1) = 0.d0</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga52f2cbc26bf83508a779335c668f2895">iep</a>,1)  = xeent</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__turbulence.html#ga422877d65f809f5110d083afaad92854">iturb</a>.eq.32) <span class="keywordflow">then</span></div>
<div class="line">      rcodcl(ifac,<a class="code" href="group__main__variables.html#ga1dad58acc909ba7f14298ada73fa1f72">ial</a>,1)  = 1.d0</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">elseif</span> (<a class="code" href="group__turbulence.html#ga65b4137820e92089e0ae2eae651509e4">itytur</a>.eq.5) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga0da9329edbed84e564928b950e9d9570">ik</a>,1)   = xkent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga52f2cbc26bf83508a779335c668f2895">iep</a>,1)  = xeent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga77858fb6ee8205a2416db13742d80fe4">iphi</a>,1) = d2s3</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__turbulence.html#ga422877d65f809f5110d083afaad92854">iturb</a>.eq.50) <span class="keywordflow">then</span></div>
<div class="line">      rcodcl(ifac,<a class="code" href="group__main__variables.html#gaa1cc52ea19b5d872238313ce1460e84a">ifb</a>,1)  = 0.d0</div>
<div class="line">    <span class="keywordflow">elseif</span> (<a class="code" href="group__turbulence.html#ga422877d65f809f5110d083afaad92854">iturb</a>.eq.51) <span class="keywordflow">then</span></div>
<div class="line">      rcodcl(ifac,<a class="code" href="group__main__variables.html#ga1dad58acc909ba7f14298ada73fa1f72">ial</a>,1)  = 0.d0</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">elseif</span> (<a class="code" href="group__turbulence.html#ga422877d65f809f5110d083afaad92854">iturb</a>.eq.60) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#ga0da9329edbed84e564928b950e9d9570">ik</a>,1)   = xkent</div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#gada4e3b8b2f79ca71ed8b3629e017bd53">iomg</a>,1) = xeent/<a class="code" href="group__csttur.html#ga019fba8a896d405a7cae1c2f960fd521">cmu</a>/xkent</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">elseif</span> (<a class="code" href="group__turbulence.html#ga422877d65f809f5110d083afaad92854">iturb</a>.eq.70) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">    rcodcl(ifac,<a class="code" href="group__main__variables.html#gaa587bbda46fe2153de41858cecbd7902">inusa</a>,1) = <a class="code" href="group__csttur.html#ga019fba8a896d405a7cae1c2f960fd521">cmu</a>*xkent**2/xeent</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">! Handle scalars</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__dimens.html#ga7eafcfac4bfc1df6ba68bd65028bca1f">nscal</a>.gt.0) <span class="keywordflow">then</span></div>
<div class="line">    <span class="keywordflow">do</span> ii = 1, <a class="code" href="group__dimens.html#ga7eafcfac4bfc1df6ba68bd65028bca1f">nscal</a></div>
<div class="line">      rcodcl(ifac,<a class="code" href="group__main__variables.html#ga2307b4d54b829b3aeeddf6c1e4e1129f">isca</a>(ii),1) = 1.d0</div>
<div class="line">    <span class="keywordflow">enddo</span></div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">enddo</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="channel_inlet_mapped_example_1_map_init"></a>
Mapping definition</h1>
<p>To define the appropriate mapping object, the <a class="el" href="classcs__c__bindings.html#a421cfb956806da6d73d170db0dd182f9">boundary_conditions_map</a> function is used. In this example, coordinates of the selected inlet face are shifted by a constant distance (5.95 meters along the <em>x</em> axis), and mapped to the corresponding mesh cells. Here, all cells are selected as point location candidates, but optionally, a restricted list of cells may be provided, which may accelerate location (or ensure it is done on a selected subset). In most cases, as in this example, a constant coordinate shift is used for all inlet points, but it is possible to define a specific shift for each face (defining a <code>stride</code> argument of 1 instead of 0 and <code>coord_shift(:,ifac)</code> instead of <code>coord_shift(:,1)</code>).</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__time__step__options.html#ga8893d91edb2d95d49bfeadfe9a3b12db">ntcabs</a>.eq.<a class="code" href="group__time__step__options.html#ga5ae62773a37fbceaa9184342b0858919">ntpabs</a>+1) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">  <span class="keyword">allocate</span>(lstcel(<a class="code" href="group__mesh.html#gab639b5ed89912ab852608e25d395a782">ncel</a>))</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">do</span> iel = 1, <a class="code" href="group__mesh.html#gab639b5ed89912ab852608e25d395a782">ncel</a></div>
<div class="line">    lstcel(iel) = iel</div>
<div class="line">  <span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line">  coord_shift(1,1) = 5.95d0</div>
<div class="line">  coord_shift(2,1) = 0.d0</div>
<div class="line">  coord_shift(3,1) = 0.d0</div>
<div class="line"></div>
<div class="line">  inlet_l = <a class="code" href="classcs__c__bindings.html#a421cfb956806da6d73d170db0dd182f9">boundary_conditions_map</a>(mesh_location_cells, <a class="code" href="group__mesh.html#gab639b5ed89912ab852608e25d395a782">ncel</a>,                &amp;</div>
<div class="line">                                    nlfac, lstcel, lstfac,                    &amp;</div>
<div class="line">                                    coord_shift, 0,                           &amp;</div>
<div class="line">                                    0.1d0)</div>
<div class="line"></div>
<div class="line">  <span class="keyword">deallocate</span>(lstcel)</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">endif</span></div>
</div><!-- fragment --><p> In general, when defining a pseudo-periodic boundary condition, it is assumed that the mesh is not moving, so the mapping may be defined once and for all. Hence the test on <a class="el" href="group__time__step__options.html#ga8893d91edb2d95d49bfeadfe9a3b12db">ntcabs</a> and <a class="el" href="group__time__step__options.html#ga5ae62773a37fbceaa9184342b0858919">ntpabs</a> and the <code>save</code> attribute for the <code>inlet_1</code> pointer.</p>
<h1><a class="anchor" id="channel_inlet_mapped_example_1_map_apply"></a>
Applying the map</h1>
<p>At all time steps after the first (possibly even the first if the flow at the mapping locations is initialized to nonzero values), the values at points mapped to inlet face centers are applied to the <code>rcodcl(ifac,1)</code> values of the corresponding faces, using the <a class="el" href="interfacecs__c__bindings_1_1boundary__conditions__mapped__set.html">boundary_conditions_mapped_set</a> subroutine. Optionally, a normalization by be applied, ensuring the mean values initially defined are preserved. Normalization is recommended for the velocity, and possibly scalars, but not for turbulent quantities, which should adapt to the velocity.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__time__step__options.html#ga8893d91edb2d95d49bfeadfe9a3b12db">ntcabs</a>.gt.1) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">  call <a class="code" href="classfield.html#a2a4a50d9ed1bb84285bd544fba2c56b5">field_get_n_fields</a>(n_fields)</div>
<div class="line">  call <a class="code" href="classfield.html#ae0f3a6278a2fd7a0d76d0dae08fbbac8">field_get_key_id</a>(<span class="stringliteral">&quot;variable_id&quot;</span>, keyvar)</div>
<div class="line">  call <a class="code" href="classfield.html#ae0f3a6278a2fd7a0d76d0dae08fbbac8">field_get_key_id</a>(<span class="stringliteral">&quot;scalar_id&quot;</span>, keysca)</div>
<div class="line"></div>
<div class="line">  interpolate = 0</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">do</span> f_id = 0, n_fields-1</div>
<div class="line">    call <a class="code" href="classfield.html#a5f63f3fbe551d4076fa8123eff37363e">field_get_key_int</a>(f_id, keyvar, ivar)</div>
<div class="line">    <span class="keywordflow">if</span> (ivar.ge.1) <span class="keywordflow">then</span></div>
<div class="line">      call <a class="code" href="classfield.html#a5f63f3fbe551d4076fa8123eff37363e">field_get_key_int</a>(f_id, keysca, iscal)</div>
<div class="line">      <span class="keywordflow">if</span> (ivar.eq.<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a> .or. iscal.gt.0) <span class="keywordflow">then</span></div>
<div class="line">        normalize = 1</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        normalize = 0</div>
<div class="line">      <span class="keywordflow">endif</span></div>
<div class="line">      call <a class="code" href="interfacecs__c__bindings_1_1boundary__conditions__mapped__set.html#a66afe685574582a7765938cfb0e7bb7b">boundary_conditions_mapped_set</a>(f_id, inlet_l, mesh_location_cells, &amp;</div>
<div class="line">                                          normalize, interpolate,             &amp;</div>
<div class="line">                                          nlfac, lstfac, rvoid,               &amp;</div>
<div class="line">                                          <a class="code" href="group__turbulence.html#ga9538a85dda673ea2fdc3ff82afe15e3a">nvarcl</a>, rcodcl)</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line">  <span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">endif</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="channel_inlet_mapped_example_1_map_clean"></a>
Finalization</h1>
<p>At the end of the computation, it is good practice to free the mapping structure:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__time__step__options.html#ga8893d91edb2d95d49bfeadfe9a3b12db">ntcabs</a>.eq.<a class="code" href="group__time__step__options.html#ga6004960e06cb99c7b484d3be1f156d87">ntmabs</a>) <span class="keywordflow">then</span></div>
<div class="line">  call <a class="code" href="classcs__c__bindings.html#acaaff9d45adf158eaf292cb00647f69c">locator_destroy</a>(inlet_l)</div>
<div class="line"><span class="keywordflow">endif</span></div>
</div><!-- fragment --></div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 6 2016 17:20:36 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
