<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Scalar balance by zone</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">programmer&#39;s documentation</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="cs_user_examples.html"><span>User&#160;examples</span></a></li>
      <li><a href="cs_var_dico.html"><span>Fortran-C&#160;naming&#160;reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="cs_user_examples.html">User examples</a></li><li class="navelem"><a class="el" href="cs_user_extra_operations_examples.html">cs_user_extra_operations.f90</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Scalar balance by zone </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="cs_user_extra_operations_examples_scalar_balance_by_zone"></a>
Scalar balance by zone</h1>
<p>This is an example of <a class="el" href="cs__user__extra__operations_8c.html#ab24cad8754d52099d4c8d540c8a4f646">cs_user_extra_operations</a> which performs scalar balances on specified zones.</p>
<h2><a class="anchor" id="cs_user_extra_operations_examples_bz_body"></a>
body</h2>
<p>The algorithm implemented in the subroutine balance_by_zone adds up contributions of fluxes on the boundary of the sub-domain defined by the user. The different contributions are classified according to their nature (inlet, outlet, wall, symmetry...) if they are boundary faces of the whole domain or according to the sign of the mass flux if they are boundary faces of the sub-domain but internal faces of the whole domain.</p>
<p>To ensure calculations have physical meaning, it is best to use a spatially uniform time step (<a class="el" href="group__time__step__options.html#ga3c439cb2b3e250cd8abc9e59c48ac12d">idtvar</a> = 0 or 1).</p>
<p>The balance at time step n over a subdomain <img class="formulaInl" alt="$ \Omega $" src="form_530.png"/> of boundary <img class="formulaInl" alt="$ \partial \Omega $" src="form_531.png"/> is equal to:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{array}{r c l} Balance^n &amp;=&amp; \displaystyle \sum_{\Omega_i \in \Omega} \norm{\vol{\celli}} \rho_\celli \left(\varia_\celli^{n-1} -\varia_\celli^n \right) \\ &amp;+&amp; \displaystyle \sum_{\Omega_i \in \Omega} \sum_{\face \in \Face{\celli}} \Delta t_\celli \varia_\celli^n \left(\rho \vect{u}\right)_\face^n \cdot \vect{S}_{\iface} \\ &amp;-&amp; \displaystyle \sum_{\face \in \partial \Omega} \Delta t_\celli \varia_\face^n \left(\rho \vect{u}\right)_\face^n \cdot \vect{S}_{\iface} \\ &amp;+&amp; \displaystyle \sum_{\face \in \partial \Omega} \Delta t_\celli K_\face \grad_\face \varia^n \cdot \vect{S}_{\iface} \\ &amp;-&amp; \displaystyle \sum_{\fib \in \partial \Omega} \Delta t_\celli \dot{m}_\ib \left(A_\ib^g + B_\ib^g \varia_\celli^n \right) \\ &amp;+&amp; \displaystyle \sum_{\fib \in \partial \Omega} \Delta t_\celli \norm{\vect{S}_\ib} \left(A_\ib^f + B_\ib^f \varia_\celli^n \right) \end{array} \]" src="form_532.png"/>
</p>
<p>The first term is negative if the amount of scalar in the volume has increased (it is 0 in a steady regime).</p>
<p>The terms of convection and diffusion (at internal or boundary faces) are positive if the amount of scalar in the volume has increased.</p>
<p>In a steady regime, a positive balance thus indicates a scalar gain.</p>
<h2><a class="anchor" id="cs_user_extra_operations_examples_example_1"></a>
Example 1</h2>
<p>This example computes energy balance relative to temperature. We assume that we want to compute balances (convective and diffusive) at the boundaries of the calculation domain.</p>
<p>The scalar considered is the temperature, nevertheless it is multiplied by the specific heat at each cell so that the computed balance is on energy, hence in Joules.</p>
<p>Here is the corresponding code:</p>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="comment">call balance_by_zone(itypfb,         &amp;</span></div>
<div class="line">                     <span class="stringliteral">&quot;all[]&quot;</span>,        &amp;</div>
<div class="line">                     <span class="stringliteral">&quot;temperature&quot;</span>)</div>
<div class="line"></div>
</div><!-- fragment --> <h2><a class="anchor" id="cs_user_extra_operations_examples_example_2"></a>
Example 2</h2>
<p>This example computes the balance relative to a scalar named "scalar1". We assume that we want to compute balances (convective and diffusive) on a box defined by two diagonally opposite points (the extrema in terms of coordinates).</p>
<p>The box criterium can be used as follows: box[ <img class="formulaInl" alt="$x_{min}$" src="form_533.png"/>, <img class="formulaInl" alt="$y_{min}$" src="form_534.png"/>, <img class="formulaInl" alt="$z_{min}$" src="form_535.png"/>, <img class="formulaInl" alt="$x_{max}$" src="form_536.png"/>, <img class="formulaInl" alt="$y_{max}$" src="form_537.png"/>, <img class="formulaInl" alt="$z_{max}$" src="form_538.png"/>].</p>
<p>Here is the corresponding code:</p>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="comment">call balance_by_zone(itypfb,                                        &amp;</span></div>
<div class="line">                     <span class="stringliteral">&quot;box[-0.5d0, 1.3d0, 0.d0, 1.d0, 1.9d0, 1.d0]&quot;</span>, &amp;</div>
<div class="line">                     <span class="stringliteral">&quot;scalar1&quot;</span>)</div>
<div class="line"></div>
</div><!-- fragment --></div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 6 2016 17:20:36 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
