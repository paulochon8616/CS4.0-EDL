<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Calculation of a local Nusselt number</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">programmer&#39;s documentation</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="cs_user_examples.html"><span>User&#160;examples</span></a></li>
      <li><a href="cs_var_dico.html"><span>Fortran-C&#160;naming&#160;reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="cs_user_examples.html">User examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Calculation of a local Nusselt number </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This function is called at the end of each time step, and has a very general purpose (<code>i.e</code>. anything that does not have another dedicated user subroutine)</p>
<h1><a class="anchor" id="cs_f_user_extra_operations"></a>
cs_f_user_extra_operations subroutine</h1>
<h2><a class="anchor" id="loc_var_f_user"></a>
Local variables</h2>
<div class="fragment"><div class="line"><span class="comment">! Local variables</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">integer</span> iscal, ivar, iortho, iprev</div>
<div class="line"><span class="keywordtype">integer</span> inc, iccocg, ilelt, irangv</div>
<div class="line"><span class="keywordtype">integer</span> ifac, iel, npoint, iel1, irang1, ii, iun, impout, nlelt, neltg</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double precision</span> diipbx, diipby, diipbz</div>
<div class="line"><span class="keywordtype">double precision</span> xtbulk, xubulk, xyz(3), xtb, xub, tfac, lambda, xab</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">character*19</span> namfil</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: lstelt</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: coefap, coefbp, cofafp</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: grad</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: treco,treglo,treloc</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: xnusselt</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: xabs, xabsg</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">pointer</span> :: vel</div>
<div class="line"><span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: cvar, viscl</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double precision</span> :: height, prandtl, qwall</div>
<div class="line">parameter(height = 1.0d0)</div>
<div class="line">parameter(prandtl = 1.0d0)</div>
<div class="line">parameter(qwall = 1.0d0)</div>
</div><!-- fragment --> <h2><a class="anchor" id="nusselt_number"></a>
Calculation of the Nusselt number</h2>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__time__step__options.html#ga8893d91edb2d95d49bfeadfe9a3b12db">ntcabs</a>.eq.<a class="code" href="group__time__step__options.html#ga6004960e06cb99c7b484d3be1f156d87">ntmabs</a>) <span class="keywordflow">then</span></div>
<div class="line"></div>
<div class="line">  <span class="keyword">allocate</span>(lstelt(max(<a class="code" href="group__mesh.html#gab639b5ed89912ab852608e25d395a782">ncel</a>,<a class="code" href="group__mesh.html#ga984b4f9c95dbef7c83f0dee8bf4168a1">nfac</a>,<a class="code" href="group__mesh.html#gafd405a008e10defbfe94d267457278c5">nfabor</a>)))</div>
<div class="line">  call <a class="code" href="classfield.html#aea9829c213afac2a2c7ad39bfb85d191">field_get_val_v</a>(<a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>), vel)</div>
<div class="line"></div>
<div class="line">  iscal = <a class="code" href="group__thermal.html#ga7bfe680df285604ff4e3e7a67ea0146e">iscalt</a>         <span class="comment">! temperature scalar number</span></div>
<div class="line">  ivar =  <a class="code" href="group__main__variables.html#ga2307b4d54b829b3aeeddf6c1e4e1129f">isca</a>(iscal)    <span class="comment">! temperature variable number</span></div>
<div class="line">  call <a class="code" href="classfield.html#a561d2e83a4150a004bb7798ade2cc000">field_get_val_s</a>(<a class="code" href="group__field__map.html#gaf42a6fc4a9bb1a28a5b835afb9615c3d">iprpfl</a>(<a class="code" href="group__physical__prop.html#ga26a9d75469d53a3f533bacdb3e771c3a">iviscl</a>), viscl)</div>
<div class="line">  call <a class="code" href="classfield.html#a11e96cf8c5dd0e7d123d48ec4bf7b98b">field_get_coefa_s</a>(<a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(ivar), coefap)</div>
<div class="line">  call <a class="code" href="classfield.html#a974abb77c62726933ac4252054982343">field_get_coefb_s</a>(<a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(ivar), coefbp)</div>
<div class="line"></div>
<div class="line">  call <a class="code" href="classfield.html#a561d2e83a4150a004bb7798ade2cc000">field_get_val_s</a>(<a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(ivar), cvar)</div>
</div><!-- fragment --> <h3><a class="anchor" id="compute_nusselt"></a>
Compute value reconstructed at I' for boundary faces</h3>
<div class="fragment"><div class="line">  <span class="keyword">allocate</span>(treco(<a class="code" href="group__mesh.html#gafd405a008e10defbfe94d267457278c5">nfabor</a>))</div>
<div class="line"></div>
<div class="line">  iortho = 0</div>
<div class="line"></div>
</div><!-- fragment --> <h3><a class="anchor" id="general_nusselt"></a>
General cas (for non-orthogonal meshes)</h3>
<div class="fragment"><div class="line">  <span class="keywordflow">if</span> (iortho.eq.0) <span class="keywordflow">then</span></div>
</div><!-- fragment --><p> Allocate a work array for the gradient calculation</p>
<div class="fragment"><div class="line">    <span class="keyword">allocate</span>(grad(3,<a class="code" href="group__mesh.html#ga639172a5bdf2c9669ddeab06a362b992">ncelet</a>))</div>
</div><!-- fragment --><p> Compute gradient</p>
<div class="fragment"><div class="line">    iprev = 0</div>
<div class="line">    inc = 1</div>
<div class="line">    iccocg = 1</div>
<div class="line"></div>
<div class="line">    call <a class="code" href="interfacefield__operator_1_1field__gradient__scalar.html#aa43d96cf868d52e6e04d47301847acc7">field_gradient_scalar</a>(<a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(ivar), iprev, <a class="code" href="group__gradient__calculation.html#ga50d456a39f909fd69848a0f9b6c80cbc">imrgra</a>, inc,    &amp;</div>
<div class="line">                               iccocg,                              &amp;</div>
<div class="line">                               grad)</div>
</div><!-- fragment --><p> Compute reconstructed value in boundary cells</p>
<div class="fragment"><div class="line">    <span class="keywordflow">do</span> ifac = 1, <a class="code" href="group__mesh.html#gafd405a008e10defbfe94d267457278c5">nfabor</a></div>
<div class="line">      iel = <a class="code" href="group__mesh.html#ga0d1cf9f4d3d0b6219ac4c4bda4797470">ifabor</a>(ifac)</div>
<div class="line">      diipbx = <a class="code" href="group__mesh.html#ga59173fc5c93d7aa132b8a7f2a0e03ba3">diipb</a>(1,ifac)</div>
<div class="line">      diipby = <a class="code" href="group__mesh.html#ga59173fc5c93d7aa132b8a7f2a0e03ba3">diipb</a>(2,ifac)</div>
<div class="line">      diipbz = <a class="code" href="group__mesh.html#ga59173fc5c93d7aa132b8a7f2a0e03ba3">diipb</a>(3,ifac)</div>
<div class="line">      treco(ifac) =   coefap(ifac) + coefbp(ifac)*(cvar(iel)       &amp;</div>
<div class="line">           + diipbx*grad(1,iel)  &amp;</div>
<div class="line">           + diipby*grad(2,iel)  &amp;</div>
<div class="line">           + diipbz*grad(3,iel))</div>
<div class="line">    <span class="keywordflow">enddo</span></div>
</div><!-- fragment --><p> Free memory</p>
<div class="fragment"><div class="line">    <span class="keyword">deallocate</span>(grad)</div>
</div><!-- fragment --> <h3><a class="anchor" id="orthogonal_nusselt"></a>
Case of orthogonal meshes</h3>
<div class="fragment"><div class="line">  <span class="keywordflow">else</span></div>
</div><!-- fragment --><p> Compute reconstructed value</p>
<dl class="section note"><dt>Note</dt><dd>Here, we assign the non-reconstructed value.</dd></dl>
<div class="fragment"><div class="line">    <span class="keywordflow">do</span> ifac = 1, <a class="code" href="group__mesh.html#gafd405a008e10defbfe94d267457278c5">nfabor</a></div>
<div class="line">      iel = <a class="code" href="group__mesh.html#ga0d1cf9f4d3d0b6219ac4c4bda4797470">ifabor</a>(ifac)</div>
<div class="line">      treco(ifac) = coefap(ifac) + coefbp(ifac)*cvar(iel)</div>
<div class="line">    <span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  impout = <a class="code" href="group__userfile.html#ga7873409e248968863e27022f8aa7462b">impusr</a>(1)</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.le.0) <span class="keywordflow">then</span></div>
<div class="line">    <span class="keyword">open</span>(file=<span class="stringliteral">&quot;Nusselt.dat&quot;</span>,unit=impout)</div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  call <a class="code" href="cs__selector__f2c_8f90.html#a15b3c47b14d96445222d40944aa0d6e1">getfbr</a>(<span class="stringliteral">&#39;normal[0,-1,0,0.1] and y &lt; 0.01&#39;</span>,nlelt,lstelt)</div>
<div class="line"></div>
<div class="line">  neltg = nlelt</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">    call <a class="code" href="interfaceparall_1_1parcpt.html#a71a96826438439a5aa3b6a65cdfc799f">parcpt</a>(neltg)</div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="keyword">allocate</span>(xabs(nlelt))</div>
<div class="line">  <span class="keyword">allocate</span>(treloc(nlelt))</div>
<div class="line">  <span class="keyword">allocate</span>(xnusselt(neltg))</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">    <span class="keyword">allocate</span>(xabsg(neltg))</div>
<div class="line">    <span class="keyword">allocate</span>(treglo(neltg))</div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">do</span> ilelt = 1, nlelt</div>
<div class="line">    ifac = lstelt(ilelt)</div>
<div class="line">    xabs(ilelt) = <a class="code" href="group__mesh.html#ga711b20cb174268b8ffcdc0e052eae53d">cdgfbo</a>(1,ifac)</div>
<div class="line">    treloc(ilelt) = treco(ifac)</div>
<div class="line">  <span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">    call <a class="code" href="interfaceparall_1_1paragv.html#a0f5a752c0903295287c8a02576473be3">paragv</a>(nlelt, neltg, xabs, xabsg)</div>
<div class="line">    call <a class="code" href="interfaceparall_1_1paragv.html#a0f5a752c0903295287c8a02576473be3">paragv</a>(nlelt, neltg, treloc, treglo)</div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">do</span> ilelt = 1,neltg</div>
</div><!-- fragment --><p> Calculation of the bulk temperature</p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">      xab = xabsg(ilelt)</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      xab = xabs(ilelt)</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">    xtbulk = 0.0d0</div>
<div class="line">    xubulk = 0.0d0</div>
<div class="line"></div>
<div class="line">    npoint = 200</div>
<div class="line">    iel1   = -999</div>
<div class="line">    <span class="keywordflow">do</span> ii = 1, npoint</div>
<div class="line">      xyz(1) = xab</div>
<div class="line">      xyz(2) = float(ii-1)/float(npoint-1)</div>
<div class="line">      xyz(3) = 0.d0</div>
<div class="line">      call <a class="code" href="cs__prototypes_8h.html#a21439fe44f37c72f6523ddd4edebacae">findpt</a>(<a class="code" href="group__mesh.html#ga639172a5bdf2c9669ddeab06a362b992">ncelet</a>, <a class="code" href="group__mesh.html#gab639b5ed89912ab852608e25d395a782">ncel</a>, <a class="code" href="group__mesh.html#gab3429385a23fd26b020626e430f294c6">xyzcen</a>, xyz(1), xyz(2), xyz(3), iel, irangv)</div>
<div class="line">      <span class="comment">!==========</span></div>
<div class="line">      <span class="keywordflow">if</span> ((iel.ne.iel1).or.(irangv.ne.irang1)) <span class="keywordflow">then</span></div>
<div class="line">        iel1   = iel</div>
<div class="line">        irang1 = irangv</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.eq.irangv) <span class="keywordflow">then</span></div>
<div class="line">          xtb = <a class="code" href="group__mesh.html#ga63281eee444c94c800bc957891033901">volume</a>(iel)*cvar(iel)*vel(1,iel)</div>
<div class="line">          xub = <a class="code" href="group__mesh.html#ga63281eee444c94c800bc957891033901">volume</a>(iel)*vel(1,iel)</div>
<div class="line">          xtbulk = xtbulk + xtb</div>
<div class="line">          xubulk = xubulk + xub</div>
<div class="line">          lambda = <a class="code" href="group__cstphy.html#ga58f2f69a0623a8b2574a3b87af07d30e">cp0</a> * viscl(iel) / prandtl</div>
<div class="line">        <span class="keywordflow">endif</span></div>
<div class="line">      <span class="keywordflow">endif</span></div>
<div class="line">    <span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">      iun = 1</div>
<div class="line">      call <a class="code" href="interfaceparall_1_1parall__bcast__r.html#a2ffd10a922d5652f9e3fb815c226873d">parall_bcast_r</a>(irangv, lambda)</div>
<div class="line">      call <a class="code" href="interfaceparall_1_1parsom.html#a424406b4b54d67ae738db5ab55be7119">parsom</a>(xtbulk)</div>
<div class="line">      call <a class="code" href="interfaceparall_1_1parsom.html#a424406b4b54d67ae738db5ab55be7119">parsom</a>(xubulk)</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">    xtbulk = xtbulk/xubulk</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">      tfac = treglo(ilelt)</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      tfac = treloc(ilelt)</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">    xnusselt(ilelt) = qwall * 2.d0 * height / lambda / (tfac - xtbulk)</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.eq.-1) <span class="keywordflow">then</span></div>
<div class="line">    <span class="keywordflow">do</span> ii = 1, neltg</div>
<div class="line">      <span class="keyword">write</span>(impout,<span class="stringliteral">&#39;(2E17.9)&#39;</span>) xabs(ii)*10, xnusselt(ii)/(0.023d0*30000.d0**(0.8d0)*0.71d0**(0.4d0))</div>
<div class="line">    <span class="keywordflow">enddo</span></div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.eq.0) <span class="keywordflow">then</span></div>
<div class="line">    call sortc2(xabsg, xnusselt, neltg)</div>
<div class="line">    <span class="keywordflow">do</span> ii = 1, neltg</div>
<div class="line">      <span class="keyword">write</span>(impout,<span class="stringliteral">&#39;(2E17.9)&#39;</span>) xabsg(ii)*10, xnusselt(ii)/(0.023d0*30000.d0**(0.8d0)*0.71d0**(0.4d0))</div>
<div class="line">    <span class="keywordflow">enddo</span></div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">  <span class="keyword">close</span>(impout)</div>
<div class="line"></div>
<div class="line">  <span class="keyword">deallocate</span>(treco)</div>
<div class="line">  <span class="keyword">deallocate</span>(xabs)</div>
<div class="line">  <span class="keyword">deallocate</span>(xnusselt)</div>
<div class="line">  <span class="keyword">deallocate</span>(lstelt)</div>
<div class="line">  <span class="keyword">deallocate</span>(treloc)</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__parall.html#ga77fe56a9acf4fc4a56b5d5ab878b7d4f">irangp</a>.ge.0) <span class="keywordflow">then</span></div>
<div class="line">    <span class="keyword">deallocate</span>(xabsg)</div>
<div class="line">    <span class="keyword">deallocate</span>(treglo)</div>
<div class="line">  <span class="keywordflow">endif</span></div>
<div class="line"><span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">return</span></div>
<div class="line"><span class="keyword">end subroutine </span><a class="code" href="cs__user__extra__operations_8f90.html#af8e8cd269b7c3e9a06a0fe909eb4c0bd">cs_f_user_extra_operations</a></div>
</div><!-- fragment --> <h1><a class="anchor" id="sortc2"></a>
sortc2 subroutine</h1>
<h2><a class="anchor" id="loc_var_sortc2"></a>
Local variables</h2>
<div class="fragment"><div class="line"><span class="keywordtype">implicit none</span></div>
<div class="line"><span class="keywordtype">integer</span> n</div>
<div class="line"><span class="keywordtype">double precision</span> tab1(n), tab2(n)</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">integer</span> ns, ii, jj, kk</div>
<div class="line"><span class="keywordtype">double precision</span> tabmin, t2</div>
</div><!-- fragment --> <h2><a class="anchor" id="body_sortc2"></a>
Body</h2>
<div class="fragment"><div class="line">ns = 1</div>
<div class="line"><span class="keywordflow">do</span> ii = 1, n-1</div>
<div class="line">  tabmin = 1.d20</div>
<div class="line">  kk = 0</div>
<div class="line">  <span class="keywordflow">do</span> jj = ns,n</div>
<div class="line">    <span class="keywordflow">if</span> (tabmin.gt.tab1(jj)) <span class="keywordflow">then</span></div>
<div class="line">      tabmin = tab1(jj)</div>
<div class="line">      kk = jj</div>
<div class="line">    <span class="keywordflow">endif</span></div>
<div class="line">  <span class="keywordflow">enddo</span></div>
<div class="line">  t2 = tab2(kk)</div>
<div class="line">  tab1(kk) = tab1(ns)</div>
<div class="line">  tab2(kk) = tab2(ns)</div>
<div class="line">  tab2(ns) = t2</div>
<div class="line">  tab1(ns) = tabmin</div>
<div class="line">  ns = ns + 1</div>
<div class="line"><span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">return</span></div>
<div class="line"><span class="keyword">end subroutine </span>sortc2</div>
</div><!-- fragment --></div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 6 2016 17:20:36 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
