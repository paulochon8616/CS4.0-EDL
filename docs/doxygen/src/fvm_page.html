<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>FVM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">programmer&#39;s documentation</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="cs_user_examples.html"><span>User&#160;examples</span></a></li>
      <li><a href="cs_var_dico.html"><span>Fortran-C&#160;naming&#160;reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FVM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="fvm"></a>
FVM: Finite Volume Mesh</h1>
<p>The "Finite Volume Mesh" library is intended to provide mesh and associated fields I/O and manipulation services for unstructure Finite Volume codes or other tools with similar requirements.</p>
<h2><a class="anchor" id="fvm_intro_goals"></a>
Goals and Limitations</h2>
<p>The FVM library is originaly intended for unstructured cell-centered finite-volume codes using almost arbitrary polyhedral cells. It may thus handle polygonal faces (convex or not) and polyhedral cells as well as more classical elements such as tetrahedra, prisms, pyramids, and hexahedra, but can currently only handle linear elements. There are also currently no optimizations for structured or block-structured meshes, wich are handled as unstructured meshes.</p>
<h2><a class="anchor" id="fvm_nodal_writer"></a>
Nodal Mesh and Writer Structures</h2>
<p>FVM is used to handle post-processing output in external formats (EnSight, CGNS, or MED are currently handled), possibly running in parallel using MPI. In the case of Code_Saturne, this implies reconstructing a nodal connectivity (cells -&gt; vertices) from the faces -&gt; cells connectivity (using an intermediate cells -&gt; faces representation, passed to th FVM API). It is also possible to directly pass a nodal connectivity to FVM.</p>
<p>So as to limit memory usage and avoid unecessary copies, the <code>fvm_nodal_t</code> structure associated to a mesh defined by its nodal connectivity is construed as a "view" on a mesh, and owns as little data as possible. As such, most main structures associated with this representation are defined by 2 arrays, one private, and one shared. For example, an fvm_nodal_t structure has 2 coordinate arrays:</p>
<p><code>const *cs_coord_t vertex_coords;</code></p>
<p><code>*cs_coord_t _vertex_coords;</code></p>
<p>If coordinates are shared with the calling code (and owned by that code), we have <code>_vertex_coords = NULL</code>, and <code>vertex_coords</code> points to the array passed from the calling code. If the coordinates array belongs to FVM (either having been "given" by the calling code, or generated by an operation wich invalidates coorindates sharing with the parent mesh, such as mesh extrusion), we have <code>vertex_coords = _vertex_coords</code>, which points to the private array.</p>
<p>When an fvm_nodal_t object is destroyed, it destroys its private data and frees the corresponding memory, but obviously leaves its shared data untouched.</p>
<p>If a <code>fvm_nodal_t</code> structure B is built from a structure A with which it shares its data, and a second <code>fvm_nodal_t</code> mesh C is a view on B (for example a restriction to a part of the domain that we whish to post-process more frequently), C must be destroyed before B, which must be destroyed before A. FVM does not use reference counters or a similar mechanism, so good managment of object lifecycles is of the responsiblity of the calling code. In practice, this logic is simple enough that no issues have been encountered with this model so far in the intended uses of the code.</p>
<p>Another associated concept is that of "parent_number": if a mesh constitutes a "view" on another, sur un autre, a list of parent entity numbers allows accessing variables associated with the "parent" mesh, without needing to extract or duplicate values at the level of the calling code.</p>
<p>Note that an FVM structure is global from an MPI point of view, as it may participate in collective parallel operations. Thus, if an FVM mesh represents a subset of a global domain, it may very well be empty for some ranks, but it must still exist on all ranks of the main communicator associated with FVM.</p>
<p>For parallelism, another important concept is that of "global numbering", corresponding to entity numbers in a "serial" or "global" version of an object: two entities (vertices, elements, ...) on different processors having a same global number correspond to the same "absolute" object. Except when explicitely mentioned, all other data defining an object is based on local definitions and numberings. Parallelism is thus made quite "transparent" to the calling code.</p>
<p>In parallel, post-processor output (using EnSight Gold, CGNS, or MED formats) uses the global numbering to serialize output, and generate a unique data set (independent of the number of processors used for the calculation). This operation is done by blocks so as to limit local memory consumption, possibly incurring a slight processing overhead. The aim is to never build a full global array on a single processor, so as to ensure scalability. This is fully implemented at least for the EnSight Gold format.</p>
<p>As an option, generic polygonal or polyhedral elements may be split into simpler elements (triangles, tetrahedra, and pyramids) for output, this being done on the fly (so as to avoid a complete memory copy). This allows working around possible lack of support for these complex elements in certain tools or formats. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 6 2016 17:20:36 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
