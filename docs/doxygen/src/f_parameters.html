<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Input of calculation parameters (Fortran modules)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">programmer&#39;s documentation</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="cs_user_examples.html"><span>User&#160;examples</span></a></li>
      <li><a href="cs_var_dico.html"><span>Fortran-C&#160;naming&#160;reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="cs_user_examples.html">User examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Input of calculation parameters (Fortran modules) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="cs_f_user_parameters_h_intro"></a>
Introduction</h1>
<p>User subroutines for input of calculation parameters (Fortran modules). These subroutines are called in all cases.</p>
<p>If the Code_Saturne GUI is used, this file is not required (but may be used to override parameters entered through the GUI, and to set parameters not accessible through the GUI).</p>
<p>Several routines are present in the file, each destined to defined specific parameters.</p>
<p>To modify the default value of parameters which do not appear in the examples provided, code should be placed as follows:</p><ul>
<li>usipsu for numerical and physical options</li>
<li>usipes for input-output related options</li>
</ul>
<p>As a convention, "specific physics" defers to the following modules only: pulverized coal, gas combustion, electric arcs.</p>
<p>In addition, specific routines are provided for the definition of some "specific physics" options. These routines are described at the end of this file and will be activated when the corresponding option is selected in the usppmo routine.</p>
<h1><a class="anchor" id="cs_f_user_parameters_h_usipsu"></a>
General options (usipsu)</h1>
<h2><a class="anchor" id="cs_f_user_parameters_h_usipsu_1"></a>
Special fields</h2>
<p>Enforce existence of 'tplus' and 'tstar' fields, so that a boundary temperature or Nusselt number may be computed using the post_boundary_temperature or post_boundary_nusselt subroutines. When postprocessing of these quantities is activated, those fields are present, but if we need to compute them in the <a class="el" href="cs__user__extra__operations_8c.html#ab24cad8754d52099d4c8d540c8a4f646">cs_user_extra_operations</a> user subroutine without postprocessing them, forcing the definition of these fields to save the values computed for the boundary layer is necessary.</p>
<div class="fragment"><div class="line">itycat = field_intensive + field_property</div>
<div class="line">ityloc = 3 <span class="comment">! boundary faces</span></div>
<div class="line">ilved = .true. <span class="comment">! interleaved</span></div>
<div class="line">inoprv = .false. <span class="comment">! no previous time step values needed</span></div>
<div class="line"></div>
<div class="line">call <a class="code" href="classfield.html#ae3213fc0704a9ce8aed555bd1fc2602b">field_get_id</a>(<span class="stringliteral">&#39;tplus&#39;</span>, f_id)</div>
<div class="line"><span class="keywordflow">if</span> (f_id.lt.0) <span class="keywordflow">then</span></div>
<div class="line">  call <a class="code" href="classfield.html#ac8ecd5b895e9e3e13cd760ea75892251">field_create</a>(<span class="stringliteral">&#39;tplus&#39;</span>, itycat, ityloc, idim1, ilved, inoprv, f_id)</div>
<div class="line"><span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">call <a class="code" href="classfield.html#ae3213fc0704a9ce8aed555bd1fc2602b">field_get_id</a>(<span class="stringliteral">&#39;tstar&#39;</span>, f_id)</div>
<div class="line"><span class="keywordflow">if</span> (f_id.lt.0) <span class="keywordflow">then</span></div>
<div class="line">  call <a class="code" href="classfield.html#ac8ecd5b895e9e3e13cd760ea75892251">field_create</a>(<span class="stringliteral">&#39;tstar&#39;</span>, itycat, ityloc, idim1, ilved, inoprv, f_id)</div>
<div class="line"><span class="keywordflow">endif</span></div>
</div><!-- fragment --><p> Save contribution of slope test for variables in special fields. These fields are automatically created, with postprocessing output enabled, if the matching variable is convected, does not use a pure upwind scheme, and has a slope test (the slope_test_upwind_id key value for a given variable's field is automatically set to the matching postprocessing field's id, or -1 if not applicable).</p>
<div class="fragment"><div class="line"><span class="comment">call field_get_key_id(&quot;slope_test_upwind_id&quot;, kislts)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">do</span> ivar = 1, <a class="code" href="group__dimens.html#gae9f2660bf124b7d70a260fec0988be04">nvar</a></div>
<div class="line">  call <a class="code" href="interfacefield_1_1field__set__key__int.html#a5c154c361b4a0ff2c9b432322465b1db">field_set_key_int</a>(<a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(ivar), kislts, 0)</div>
<div class="line"><span class="keywordflow">enddo</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="cs_f_user_parameters_h_usipes"></a>
Input-output related examples (usipes)</h1>
<h2><a class="anchor" id="cs_f_user_parameters_h_example_base"></a>
Basic options</h2>
<p>Frequency of log output.</p>
<div class="fragment"><div class="line"><a class="code" href="group__listing.html#ga600df5a42d4003b3ee59383ec0c362fd">ntlist</a> = 1</div>
</div><!-- fragment --><p> Log (listing) verbosity.</p>
<div class="fragment"><div class="line"><span class="keywordflow">do</span> ii = 1, <a class="code" href="group__dimens.html#gae9f2660bf124b7d70a260fec0988be04">nvar</a></div>
<div class="line">  <a class="code" href="group__entsor.html#ga24acc5de13a2c3d6d3d321a754820237">iwarni</a>(ii) = 1</div>
<div class="line"><span class="keywordflow">enddo</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__entsor.html#ga24acc5de13a2c3d6d3d321a754820237">iwarni</a>(<a class="code" href="group__main__variables.html#gad6a04316c3de6fdce7585d9847515b8a">ipr</a>) = 2</div>
<div class="line"><a class="code" href="group__entsor.html#ga24acc5de13a2c3d6d3d321a754820237">iwarni</a>(<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>) = 2</div>
<div class="line"><a class="code" href="group__entsor.html#ga24acc5de13a2c3d6d3d321a754820237">iwarni</a>(<a class="code" href="group__main__variables.html#ga92b62f3d921525535a93525229a106a2">iv</a>) = 2</div>
<div class="line"><a class="code" href="group__entsor.html#ga24acc5de13a2c3d6d3d321a754820237">iwarni</a>(<a class="code" href="group__main__variables.html#gafe8e8df233ec94d884116c7d0aa29ef2">iw</a>) = 2</div>
</div><!-- fragment --><p> Activate or deactivate logging output. By default, logging is active for most variables. In the following example, logging for velocity is deactivated.</p>
<div class="fragment"><div class="line">f_id = <a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>)</div>
<div class="line">ifllog = 0</div>
<div class="line">call <a class="code" href="interfacefield_1_1field__set__key__int.html#a5c154c361b4a0ff2c9b432322465b1db">field_set_key_int</a>(f_id, <a class="code" href="group__entsor.html#ga3b2bcc83344528a863e4a1f9589d8026">keyvis</a>, ifllog)</div>
</div><!-- fragment --><p> Change a property's label (here for density, first checking if it is variable). A field's name cannot be changed, but its label, used for logging and postprocessing output, may be redefined.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__physical__prop.html#gafbdcaf999c072e2bad96f5c08686c63d">icp</a>.ne.0) <span class="keywordflow">then</span></div>
<div class="line">  f_id = <a class="code" href="group__field__map.html#gaf42a6fc4a9bb1a28a5b835afb9615c3d">iprpfl</a>(<a class="code" href="group__physical__prop.html#gafbdcaf999c072e2bad96f5c08686c63d">icp</a>)</div>
<div class="line">  call <a class="code" href="classfield.html#a0f35414db80bd68ce5c9d84f7ec09f35">field_set_key_str</a>(f_id, <a class="code" href="group__entsor.html#gaca0e71d7c0f6e12d5e0c157a2488f47c">keylbl</a>, <span class="stringliteral">&#39;Cp&#39;</span>)</div>
<div class="line"><span class="keywordflow">endif</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="cs_f_user_parameters_h_example_probes"></a>
Probes output</h2>
<p>Probes output step.</p>
<div class="fragment"><div class="line"><a class="code" href="group__history.html#gaf5bd98518fee4c06f5f655abb731b0dd">nthist</a> = 1</div>
<div class="line"><a class="code" href="group__history.html#ga2a033560c1c2cf7f7145ff4831f85820">frhist</a> = -1.d0</div>
</div><!-- fragment --><p> Number of monitoring points (probes) and their positions. Limited to ncaptm=100.</p>
<div class="fragment"><div class="line"><a class="code" href="group__history.html#ga2c9818686ef040d49ab54fedeefd6d31">ncapt</a>  = 4</div>
<div class="line"><a class="code" href="group__history.html#gab17ae7853bdcc84d4d7d57b912e4cf66">tplfmt</a> = 1 <span class="comment">! time plot format (1: .dat, 2: .csv, 3: both)</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(1,1) = 0.30d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(2,1) = 0.15d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(3,1) = 0.01d0</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(1,2) = 0.30d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(2,2) = 0.00d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(3,2) = 0.01d0</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(1,3) = 0.30d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(2,3) =-0.08d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(3,3) = 0.01d0</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(1,4) = 0.60d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(2,4) =-0.05d0</div>
<div class="line"><a class="code" href="group__history.html#gae9ab3bf64d0ee3de89faa3f0b5fc6df9">xyzcap</a>(3,4) = 0.01d0</div>
</div><!-- fragment --> <h2><a class="anchor" id="cs_f_user_parameters_h_example_post"></a>
Postprocessing output</h2>
<p>Activate or deactivate postprocessing output. By default, output is active for most variables. In the following example, the output for velocity is deactivated.</p>
<div class="fragment"><div class="line">f_id = <a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>)</div>
<div class="line">iflpst = 0</div>
<div class="line">call <a class="code" href="interfacefield_1_1field__set__key__int.html#a5c154c361b4a0ff2c9b432322465b1db">field_set_key_int</a>(f_id, <a class="code" href="group__entsor.html#ga3b2bcc83344528a863e4a1f9589d8026">keyvis</a>, iflpst)</div>
</div><!-- fragment --><p> Activate or deactivate probes output. If <a class="el" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(.,1) = -1, output is done for all probes. In the following example, probes output for the velocity is restricted to the first component.</p>
<div class="fragment"><div class="line">f_id = <a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>)</div>
<div class="line">ipp = <a class="code" href="classentsor.html#a12485f929404530b58ec87f329db821e">field_post_id</a>(f_id)</div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp,1) = -1</div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp+1,1) = 0</div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp+2,1) = 0</div>
</div><!-- fragment --> <pre class="fragment">  Probes for Radiative Transfer (Luminance and radiative density flux vector)
</pre><p> for all probes (ihisvr = -1)</p>
<div class="fragment"><div class="line"><span class="comment">call field_get_id_try(&#39;luminance&#39;, f_id)</span></div>
<div class="line">ipp = <a class="code" href="classentsor.html#a12485f929404530b58ec87f329db821e">field_post_id</a>(f_id)</div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp,1) = -1</div>
<div class="line"></div>
<div class="line"><span class="comment">call field_get_id_try(&#39;radiative_flux&#39;, f_id)</span></div>
<div class="line"><span class="comment">! X component</span></div>
<div class="line">ipp = <a class="code" href="classentsor.html#a12485f929404530b58ec87f329db821e">field_post_id</a>(f_id)</div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp,1) = -1</div>
<div class="line"><span class="comment">! Y component</span></div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp+1,1) = -1</div>
<div class="line"><span class="comment">! Z component</span></div>
<div class="line"><a class="code" href="group__history.html#gaeaceb1ebfdca115ee715a83e69c74074">ihisvr</a>(ipp+2,1) = -1</div>
</div><!-- fragment --> <h2><a class="anchor" id="cs_f_user_parameters_h_example_1"></a>
Postprocess at boundary</h2>
<p>Force postprocessing of projection of some variables at boundary with no reconstruction. This is handled automatically if the second bit of a field's 'post_vis' key value is set to 1 (which amounts to adding 2 to that key value).</p>
<div class="fragment"><div class="line">f_id = <a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(<a class="code" href="group__main__variables.html#gab6cfa74e47a0d12d050a2754262a4b95">iu</a>)</div>
<div class="line"><span class="keywordflow">if</span> (iand(iflpst, 2) .eq. 0) <span class="keywordflow">then</span></div>
<div class="line">  call <a class="code" href="classfield.html#a5f63f3fbe551d4076fa8123eff37363e">field_get_key_int</a>(f_id, <a class="code" href="group__entsor.html#ga3b2bcc83344528a863e4a1f9589d8026">keyvis</a>, iflpst)</div>
<div class="line">  iflpst = ior(iflpst, 2)</div>
<div class="line">  call <a class="code" href="interfacefield_1_1field__set__key__int.html#a5c154c361b4a0ff2c9b432322465b1db">field_set_key_int</a>(f_id, <a class="code" href="group__entsor.html#ga3b2bcc83344528a863e4a1f9589d8026">keyvis</a>, iflpst)</div>
<div class="line"><span class="keywordflow">endif</span></div>
<div class="line"></div>
<div class="line">f_id = <a class="code" href="group__field__map.html#ga57aa6fc90649d0b34039aa88d2fec6f4">ivarfl</a>(<a class="code" href="group__main__variables.html#gad6a04316c3de6fdce7585d9847515b8a">ipr</a>)</div>
<div class="line"><span class="keywordflow">if</span> (iand(iflpst, 2) .eq. 0) <span class="keywordflow">then</span></div>
<div class="line">  call <a class="code" href="classfield.html#a5f63f3fbe551d4076fa8123eff37363e">field_get_key_int</a>(f_id, <a class="code" href="group__entsor.html#ga3b2bcc83344528a863e4a1f9589d8026">keyvis</a>, iflpst)</div>
<div class="line">  iflpst = ior(iflpst, 2)</div>
<div class="line">  call <a class="code" href="interfacefield_1_1field__set__key__int.html#a5c154c361b4a0ff2c9b432322465b1db">field_set_key_int</a>(f_id, <a class="code" href="group__entsor.html#ga3b2bcc83344528a863e4a1f9589d8026">keyvis</a>, iflpst)</div>
<div class="line"><span class="keywordflow">endif</span></div>
</div><!-- fragment --></div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 6 2016 17:20:36 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
